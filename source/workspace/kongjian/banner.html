<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./public/styles/css.css" />
    <!--[if lt IE 9]>
      <script src="./public/javascript/html5shiv.min.js"></script>
      <script src="./public/javascript/respond.min.js"></script>
    <![endif]-->
    <title>Banner</title>
</head>
<body>
    <div class="navbar navbar-fixed-top app-nav-top">
        <div class="app-logo left">
            <h1>Logo</h1>
        </div>

        <div class="app-nav-setting right">
            <span>超级管理员</span>
            <!-- <a href="#">WQS</a> -->
            <div class="dropdown">
              <a id="drop" data-target="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">WQS<span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="drop">
                <li><a href="./modify-password.html">修改密码</a></li>
                <li><a href="./login.html">退出</a></li>
              </ul>
            </div>
        </div>
    </div>
    <div class="app-container">
        <div class="app-left">
            <ul>
                <li><a href="./organization.html">组织机构</a></li>
                <li><a href="./role.html">角色管理</a></li>
                <li><a href="./user.html">用户管理</a></li>
            </ul>

            <ul>
                <li><a href="./home.html">首页</a></li>
                <li><a href="./enterprise-info.html">企业信息管理</a></li>
                <li class="active"><a href="./banner.html">banner管理</a></li>
                <li><a href="./space.html">空间管理</a></li>
                <li><a href="./new.html">资讯管理</a></li>
                <li><a href="./booking.html">预约管理</a></li>
            </ul>

        </div>

        <div class="app-main">
            <div class="breadcrumb-wrap">
                <ol class="breadcrumb">
                
                    <li><a href="#">首页</a></li>
                
                    <li><a href="#">banner管理</a></li>
                
                </ol>
            </div>


            <div class="main container-fluid">
                <div class="banner-wrap">
                    <div class="banner-upload-list">
                        <h2>首页Banner</h2>
                        <div class="list-table-box-wrap" id="home-banner-box-wrap"></div>
                        <div class="list-table-footer">
                            <button class="btn btn-info uploader-btn" id="home-banner-upload-btn">图片上传</button>
                            <button class="btn btn-primary" id="home-banner-save-btn">保存</button>
                        </div>

                    </div>
                    <div class="banner-upload-list">
                        <h2>新闻Banner</h2>
                        <div class="list-table-box-wrap" id="new-banner-box-wrap"></div>

                        <div class="list-table-footer">
                            <button class="btn btn-info uploader-btn" id="new-banner-upload-btn">图片上传</button>
                            <button class="btn btn-primary" id="new-banner-save-btn">保存</button>
                        </div>
                    </div>


                    <div class="banner-upload-list last">
                        <h2>关于我们Banner</h2>
                        <div class="list-table-box-wrap" id="about-banner-box-wrap"></div>

                        <div class="list-table-footer">
                            <button class="btn btn-info uploader-btn" id="about-banner-upload-btn">图片上传</button>
                            <button class="btn btn-primary" id="about-banner-save-btn">保存</button>
                        </div>

                    </div>



                </div>

            </div>
        </div>

    </div>

</body>
<script type="text/javascript" src="./public/javascript/jquery.js"></script>
<script type="text/javascript" src="./public/javascript/bootstrap.min.js"></script>
<script type="text/javascript" src="./public/javascript/webuploader.min.js"></script>
<script type="text/javascript">

    $(function(){

        new Upload("#home-banner-upload-btn", "#home-banner-box-wrap", "#home-banner-save-btn");
        new Upload("#new-banner-upload-btn", "#new-banner-box-wrap", "#new-banner-save-btn");
        new Upload("#about-banner-upload-btn", "#about-banner-box-wrap","#about-banner-save-btn");


        function Upload(pick, box, save){
            var uploader = WebUploader.create({
                // swf文件路径
                swf: './public/javascript/Uploader.swf',
                // 文件接收服务端。
                server: 'http://45.77.198.135/case/anshu.dev/server/fileupload.php',
                // 选择文件的按钮。可选。
                // 内部根据当前运行是创建，可能是input元素，也可能是flash.
                pick: pick,
                //auto: true,
                accept: {
                  title: 'Images',
                  extensions: 'gif,jpg,jpeg,bmp,png',
                  mimeTypes: 'image/*'
                },
                fileNumLimit: 3,
                // 不压缩image, 默认如果是jpeg，文件上传前会压缩一把再上传！
                resize: false
            });

            uploader.on( 'fileQueued', function( file, percentage ) {
                var $li = $(
                        '<div class="list-table-box" id="'+file.id+'">'
                        +        '<div class="list-table-td list-table-index"></div>'
                        +        '<div class="list-table-td list-table-thumb"><img src="./public/img/1.jpg" alt=""></div>'
                        +        '<div class="list-table-td list-table-operation">'  
                        +        '</div>'
                        +'</div>'
                        ),
                $img = $li.find('img');
                $delBtn = $('<button class="btn btn-danger">删除</button>');
                $li.find(".list-table-operation").append($delBtn);
                // $list为容器jQuery实例
                $(box).append( $li );
                // 创建缩略图
                // 如果为非图片文件，可以不用调用此方法。
                // thumbnailWidth x thumbnailHeight 为 100 x 100
                uploader.makeThumb( file, function( error, src ) {
                    if ( error ) {
                        $img.replaceWith('<span style="width:220px; display:inline-block;">不能预览</span>');
                        return;
                    }

                    $img.attr( 'src', src );

                    $(box).find(".list-table-index").each(function(index){
                        $(this).html(index+1)
                    })
                }, 220, 80 );

                $delBtn.on("click", function(){
                    $(this).parent().parent().remove();
                    uploader.removeFile(file)
                    $(box).find(".list-table-index").each(function(index){
                        $(this).html(index+1)
                    })
                });

                $(save).on("click", function(){
                    uploader.upload();
                })
            });

            
        }

        
    })
</script>
</html>
